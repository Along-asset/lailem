# 公司人员管理（ESA Pages + Edge Functions + KV）

面向月嫂公司和家政机构的在线人员展示与管理系统。
【主要对象】自己手上有资源的个人老板，既方便自己管理，也方便客户查看。  
前台用于向客户统一展示工作人员信息，后台则支持管理员在浏览器中完成人员资料的新增、编辑、排序和图片维护，提交后首页自动按统一卡片样式与权重规则排版展示。

> 在线访问地址：`lailem.c2cb9b42.er.aliyun-esa.net`  
> GitHub 仓库地址：https://github.com/Along-asset/lailem

## 阿里云 ESA Pages 声明

本项目由阿里云ESA提供加速、计算和保护

![阿里云ESA Pages，构建、加速并保护你的网站](https://img.alicdn.com/imgextra/i1/O1CN016eN9qK1mzWfLq6xKq_!!6000000005026-0-tps-884-138.jpg)

## 项目简介与核心功能

### 面向访客（客户侧）

- 首页卡片列表：以统一比例的人员卡片展示姓名、区域、年限、状态、亮点和头像。
- 搜索与筛选：支持按“姓名 / 区域 / 技能 / 简介”模糊搜索，并按“全部状态 / 可接单 / 档期满”筛选。
- 技能标签：技能以彩色标签形式展示，不同标签自动分配不同配色，提升可读性和视觉层次。
- 详情页介绍：点击任意人员卡片进入详情页，可查看完整简介、技能标签列表以及多分组照片集。
- 照片分组与放大：支持多分组照片展示，点击任一图片可在居中浮层中放大查看，兼顾体验与美观。

### 面向管理员（运营侧）

- 管理后台登录：通过管理员口令登录，登录后可访问人员管理后台。
【当前项目的管理员口令为：123456789】管理员口令在首次登录后会被加密存储在KV中，后续登录时会与加密后的口令进行对比验证。
- 人员列表管理：以表格形式展示所有人员，可查看头像、区域、状态、排序权重，并支持编辑和删除。
- 新建表单：点击“新增人员”或“编辑”后，从屏幕中央弹出表单，保证在同一页面内完成所有信息维护。
- 信息字段：
  - 基础信息：姓名、服务区域、从业年限、接单状态（一键切换“可接单/档期满”）。
  - 展示信息：一句话亮点、详细简介、技能标签（支持逗号、顿号、空格分隔自动拆分）。
  - 图片维护：上传头像（前端自动压缩体积与尺寸）以及多分组场景照片。
  - 排序权重：通过自定义排序权重控制首页展示顺序，支持自定义上下调节按钮精细调整。
- 【AI 文案润色】：集成通义千问接口，为月嫂简介提供一键“AI 润色”，在不改变事实的前提下提升表达质量。
- 删除确认弹窗：删除人员前会弹出中心确认窗口，并明确显示被删除人员姓名，避免误操作。
- 细节打磨：
  - 所有输入控件继承统一项目字体。
  - 抽屉内部滚动条做了自定义美化，与整体深色玻璃质感 UI 保持一致。

## 创意性 · 应用价值 · 技术探索

### 创意性（创意卓越）

- 场景聚焦：针对“月嫂公司人员展示”这一垂直场景进行设计，让评委一眼理解业务价值与目标用户。
- 视觉设计：采用深色玻璃质感背景、柔和渐变与统一圆角体系，配合全屏封面图和可选背景视频，使整体观感现代、专业。
- 信息组织：主页只展示用户最关心的信息（姓名、区域、年限、可接单状态和亮点），详细内容收敛到详情页；技能以彩色标签分布，照片按分组管理，整体信息结构清晰。
- 交互体验：
  - 抽屉式表单避免频繁页面跳转。
  - 删除操作使用自定义弹窗且包含人员姓名，强调安全感。
  - 细节如滚动条、数字输入按钮等均做定制化，让后台体验不再“工具化粗糙”，更像成品 SaaS。

### 应用价值（使用价值与可传播性）

- 典型应用场景：
  - 月嫂公司/家政机构对外官网“人员展示”栏目。
  - 小型家政团队的内部人员管理面板。
  - 其他需要“人员卡片展示 + 后台管理”的中小企业，可以稍作字段修改后直接部署使用。
- 开箱即用：
  - 管理后台从浏览器登录即可使用，无需安装客户端。
  - 所有数据存储在 ESA 边缘 KV，部署后立即可用，只需配置管理员口令和 KV 命名空间。
  - 前端采用 SPA 路由，访客浏览体验接近原生应用。
- 内容维护成本低：
  - 技能标签自动拆分与着色，避免复杂表格配置。
  - 一键 AI 润色简介，帮助不会写文案的运营人员快速产出适合对外展示的内容。
  - 图片前端压缩后再写入 KV，减少带宽与存储成本，同时保证加载速度。

### 技术探索（基于 ESA 生态的边缘实践）

- 完整使用 ESA 边缘产品构建：
  - **Pages**：托管前端静态资源，负责构建与全球边缘分发。
  - **Edge Functions**：在边缘节点提供 RESTful API，包括管理员登录、人员的增删改查、单条详情查询等。
  - **Edge KV**：通过 KV 存储人员数据与索引列表，实现就近读写、按域名隔离租户，以及快速扩容。
- 安全与多租户设计：
  - 管理员登录采用 HMAC 签名 Token，Token 中包含角色与过期时间。
  - 针对不同域名自动划分“租户 ID”，不同域名共享同一套代码但数据物理隔离。
  - 管理员密码仅以哈希形式保存在 KV 中，首次配置后即可长期使用。
- 数据与性能优化：
  - 前端在上传图片前进行尺寸与质量压缩，限制头像和照片的最大体积，降低 KV 存储成本与传输延迟。
  - 后端对技能标签、照片分组数量做上限控制，保证单条人员数据在边缘环境中的序列化与反序列化性能。
  - 列表接口按“排序权重 + 更新时间”进行排序，保证首页始终优先展示重点人员。

## 技术栈一览

- 前端：React + TypeScript + Vite
- 路由：React Router
- 样式：原生 CSS，深色玻璃质感自定义设计，移动端友好布局
- 边缘计算：阿里云 ESA Edge Functions
- 数据存储：阿里云 ESA Edge KV
- 构建与托管：阿里云 ESA Pages（支持单页应用路由）

## 本地开发

```bash
npm install
npm run dev
```

说明：本地 `npm run dev` 仅用于前端开发。`/api/*` 在本地不会可用，需要部署到 ESA 后由边缘函数提供。

## 部署到 ESA Pages

1. 仓库根目录已包含 `esa.jsonc`，用于配置：
   - 静态资源目录：`./dist`
   - SPA 路由策略：`singlePageApplication`（刷新子路由不 404）
   - 边缘函数入口：`./src/edge/index.js`
2. 在 ESA 控制台创建 KV 命名空间，并设置环境变量：
   - `ESA_KV_NAMESPACE`：KV 命名空间名称（默认使用 `lailem_staff`）
   - `ADMIN_PASSWORD`：管理员初始口令
   - `TOKEN_SECRET`：Token 签名密钥（建议设置为高强度随机值）
3. 在 ESA Pages 控制台中：
   - 连接本 GitHub 仓库。
   - 构建命令设置为 `npm run build`，构建输出目录为 `dist`。
   - 关联上述 KV 命名空间与环境变量后完成部署。

## API 概览（由 Edge Functions 提供）

- `GET /api/health`  
  健康检查，用于验证边缘函数是否正常运行。
- `POST /api/admin/login`  
  请求体：`{ "password": string }`；响应：`{ "token": string }`。用于管理员登录并获取 Bearer Token。
- `GET /api/staff`  
  获取全部人员列表（按排序权重与更新时间排序）。
- `GET /api/staff/:id`  
  获取单个工作人员详情。
- `POST /api/staff`（需管理员 Token）  
  新增人员。
- `PUT /api/staff/:id`（需管理员 Token）  
  更新人员信息。
- `DELETE /api/staff/:id`（需管理员 Token）  
  删除人员及其索引。
